Metadata-Version: 2.1
Name: wecmdbsrv-cfomp
Version: 1.2.2
Summary: Wxwork callback service for HOST CMDB
Author: chenhp
Author-email: chenhp@shchinaforutne.com
License-File: LICENSE
Requires-Dist: elasticsearch <7.18.0,>=7.17.0
Requires-Dist: Flask >=2.1.1
Requires-Dist: IPy >=1.01
Requires-Dist: setuptools >=49.2.1
Requires-Dist: Werkzeug >=2.0.1
Requires-Dist: xmltodict >=0.12.0
Requires-Dist: weworkapi-cfomp >=1.1.4
Requires-Dist: gunicorn >=20.1.0

# 运管平台企业微信主机CMDB查询回调服务
运管平台`主机CMDB查询`应用，用户在应用中输入检索的文本，企业微信回调此服务，返回给用户包含查询主机列表的外部超链接。用户点击链接，验证身份通过之后便可得到检索的结果。

## 使用说明
运行时依赖以下环境变量
| Environment variable | Description | Default |
| --- | --- | --- |
| SECRET_KEY | Flask native config| None |
| WEWORK_TOKEN | 企业微信应用的TOKEN | None |
| WEWORK_ENCODING_AES_KEY | 企业微信应用的AES密钥 | None |
| WEWORK_CORPID | 企业微信的企业ID| None |
| WEWORK_AGENTID | 企业微信内应用的ID | None |
| WEWORK_SECRET | 企业微信内应用的Secret| None |
| ES_HOSTS | Elasticsearch host list| localhost |
| ES_SIZE | Elasticsearch search size limit | 20 |
| ES_TIMEOUT | Elasticsearch search timeouts | None |
| EXTERNAL_URL | Flask native config| https://cfomp.shchinafortune.com/wecmdbsrv |
| URL_PREFIX | Flask native config| /wecmdbsrv |

## 注意事项
1. 可以把运行时依赖的环境变量配置到文件中，如`/etc/wecmdbsrv/setting.cfg`, 然后设置`PROJECT_SETTING`环境变量指向这个文件，`PROJECT_SETTING=/etc/wecmdbsrv/setting.cfg`
1. 运行时需要向https://open.weixin.qq.com/connect/oauth2/authorize 获取OAuth2 token，然后验证用户身份。请依据主机网络是否设置`https_proxy`环境变量
