(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[63],{96795:function(n,e,t){var r=t(36740)(function(n,e,t){n[t?0:1].push(e)},function(){return[[],[]]});n.exports=r},78945:function(n,e,t){"use strict";t.d(e,{_:function(){return s}});var r=t(73235),u=t(40794),i=t(60138);function o(){var n=(0,r._)(["\n  query InstanceConfigHasInfo {\n    instance {\n      id\n      hasInfo\n    }\n  }\n"]);return o=function(){return n},n}var s=function(){var n=(0,u.a)(a).data;return!!(null==n?void 0:n.instance.hasInfo)},a=(0,i.Ps)(o())},46928:function(n,e,t){"use strict";t.d(e,{Q1:function(){return k},Qf:function(){return q},zc:function(){return j}});var r=t(85333),u=t(6692),i=t(58467),o=t(73235),s=t(82550),a=t(52322),l=t(40794),c=t(60138),d=t(9001),f=t(86412),h=t(18149),p=t.n(h),v=t(2784),m=t(7267),x=t(35505),g=t(28252),y=t(16148),b=t(6315),R=t(49313);function _(){var n=(0,o._)(["\n  ","\n"]);return _=function(){return n},n}function C(){var n=(0,o._)(["\n  query RunTabsCountQuery($queuedFilter: RunsFilter!, $inProgressFilter: RunsFilter!) {\n    queuedCount: pipelineRunsOrError(filter: $queuedFilter) {\n      ... on Runs {\n        count\n      }\n    }\n    inProgressCount: pipelineRunsOrError(filter: $inProgressFilter) {\n      ... on Runs {\n        count\n      }\n    }\n  }\n"]);return C=function(){return n},n}var w=function(n){switch(n){case"all":return"Runs | All runs";case"failed":return"Runs | Failed";case"in-progress":return"Runs | In progress";case"queued":return"Runs | Queued";case"scheduled":return"Runs | Scheduled";default:return"Runs"}},j=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(0,l.a)(E,{variables:{queuedFilter:(0,u._)((0,r._)({},n),{statuses:Array.from(b.sy)}),inProgressFilter:(0,u._)((0,r._)({},n),{statuses:Array.from(b.Ys)})}}),t=e.data,o=v.useMemo(function(){var n,e;return{queuedCount:(null==t?void 0:null===(n=t.queuedCount)||void 0===n?void 0:n.__typename)==="Runs"?t.queuedCount.count:null,inProgressCount:(null==t?void 0:null===(e=t.inProgressCount)||void 0===e?void 0:e.__typename)==="Runs"?t.inProgressCount.count:null}},[t]),c=o.queuedCount,f=o.inProgressCount,h=(0,i._)((0,R.oD)(),1)[0],p=q(h);(0,g.j)(w(p));var m=function(n){var e=h.filter(function(n){return"status"!==n.token}),t=n.map(function(n){return{token:"status",value:n}});return(0,R.it)((0,s._)(t).concat((0,s._)(e)))};return{tabs:(0,a.jsxs)(d.zH,{children:[(0,a.jsx)(k,{to:m([]),id:"all",$active:"all"===p,children:"All runs"}),(0,a.jsxs)(k,{to:m(Array.from(b.sy)),id:"queued",$active:"queued"===p,children:["Queued (",null!=c?c:"indeterminate",")"]}),(0,a.jsxs)(k,{to:m(Array.from(b.Ys)),id:"in-progress",$active:"in-progress"===p,children:["In progress (",null!=f?f:"indeterminate",")"]}),(0,a.jsx)(k,{to:m(Array.from(b.hd)),id:"failed",$active:"failed"===p,children:"Failed"}),(0,a.jsx)(k,{title:"Scheduled",to:"/runs/scheduled",id:"scheduled",$active:"scheduled"===p,children:"Scheduled"})]}),queryResult:e}},k=(0,x.ZP)(y.A).withConfig({componentId:"sc-8862b5f1-0"})(_(),function(n){return n.$active&&"\n    background: ".concat(f.w.Gray200,";\n  ")}),q=function(n){var e=(0,m.TH)().pathname;if("/runs/timeline"===e)return"timeline";if("/runs/scheduled"===e)return"scheduled";if("/overview/backfills"===e)return"backfills";var t=new Set(n.filter(function(n){return"status"===n.token}).map(function(n){return n.value}));return p()(b.sy,t)?"queued":p()(b.Ys,t)?"in-progress":p()(b.hd,t)?"failed":"all"},E=(0,c.Ps)(C())},5063:function(n,e,t){"use strict";t.r(e),t.d(e,{RUNS_ROOT_QUERY:function(){return ne},RunsRoot:function(){return X},default:function(){return nn}});var r=t(85333),u=t(58467),i=t(73235),o=t(82550),s=t(52322),a=t(60138),l=t(18399),c=t(21221),d=t(28888),f=t(17131),h=t(81308),p=t(92364),v=t(12084),m=t(83302),x=t(96795),g=t.n(x),y=t(2784),b=t(91195),R=t(55237),_=t(68028),C=t(28316);function w(n){var e=n.node,t=y.useRef(null);return y.useLayoutEffect(function(){var n=t.current;if(e.parentNode!==n){if(null!==e.parentNode&&e.parentNode!==n)throw Error("Cannot render the same node twice");return null==n||n.appendChild(e),function(){null==n||n.removeChild(e)}}},[e]),(0,s.jsx)("div",{ref:t})}var j=t(90894),k=t(19358),q=t(40794),E=t(9676),P=t(47933),F=t(74897),T=t(78945);function A(){var n=(0,i._)(['\n  query QueueDaemonStatusQuery {\n    instance {\n      id\n      daemonHealth {\n        id\n        daemonStatus(daemonType: "QUEUED_RUN_COORDINATOR") {\n          id\n          daemonType\n          healthy\n          required\n        }\n      }\n    }\n  }\n']);return A=function(){return n},n}var S=function(){var n=(0,T._)();return(0,s.jsxs)(l.x,{flex:{direction:"column",gap:8},style:{minWidth:"100%"},border:"bottom",children:[n&&(0,s.jsx)(E.b,{intent:"info",title:(0,s.jsx)(P.rU,{to:"/config#run_coordinator",children:"View queue configuration"})}),n&&(0,s.jsx)($,{})]})},$=function(){var n=(0,q.a)(O).data,e=y.useContext(F.N).pageTitle,t=null==n?void 0:n.instance.daemonHealth.daemonStatus;return(null==t?void 0:t.required)&&!(null==t?void 0:t.healthy)?(0,s.jsx)(E.b,{intent:"warning",title:"The queued run coordinator is not healthy.",description:(0,s.jsxs)("div",{children:["View ",(0,s.jsx)(P.rU,{to:"/health",children:e})," for details."]})}):null},O=(0,a.Ps)(A()),I=t(46928),Q=t(6315),N=t(62262),z=t(38917),Y=t(49313),H=t(81862),U=t(22970),D=t(56675),V=t(9001),Z=t(18149),L=t.n(Z),W=t(16322);function B(){var n=(0,i._)(["\n  query TerminateRunIdsQuery($filter: RunsFilter!) {\n    pipelineRunsOrError(filter: $filter) {\n      ... on Runs {\n        results {\n          id\n          status\n          canTerminate\n        }\n      }\n    }\n  }\n"]);return B=function(){return n},n}var M=function(n){var e,t=n.refetch,r=n.filter,i=n.disabled,o=(0,u._)(y.useState(null),2),a=o[0],l=o[1],c=(0,D.x)(),d=(e=(0,H._)(function(){var n;return(0,U.Jh)(this,function(e){switch(e.label){case 0:return[4,c.query({query:G,variables:{filter:r}})];case 1:return l("Runs"===(n=e.sent()).data.pipelineRunsOrError.__typename?Object.fromEntries(n.data.pipelineRunsOrError.results.map(function(n){return[n.id,n.canTerminate]})):{}),[2]}})}),function(){return e.apply(this,arguments)});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W.A,{isOpen:null!==a,selectedRuns:a||{},selectedRunsAllQueued:L()(r,{statuses:Array.from(Q.sy)}),onClose:function(){return l(null)},onComplete:function(){return t()}}),(0,s.jsx)(V.zx,{intent:"danger",outlined:!0,disabled:i,onClick:d,children:"Terminate allâ€¦"})]})},G=(0,a.Ps)(B()),J=t(65767);function K(){var n=(0,i._)(["\n  query RunsRootQuery($limit: Int, $cursor: String, $filter: RunsFilter!) {\n    pipelineRunsOrError(limit: $limit, cursor: $cursor, filter: $filter) {\n      ... on Runs {\n        results {\n          id\n          ...RunTableRunFragment\n        }\n      }\n      ... on InvalidPipelineRunsFilterError {\n        message\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return K=function(){return n},n}var X=function(){var n,e,t,i=function(){var n,e,t,r;return(0,s.jsxs)(l.x,{style:{width:"100%",marginRight:8},flex:{justifyContent:"space-between"},children:[(0,s.jsxs)(l.x,{flex:{direction:"row",alignItems:"center",gap:8},children:[B,no]}),"queued"===A?(0,s.jsx)(M,{refetch:X.refetch,filter:{statuses:Array.from(Q.sy)},disabled:(null===(n=G.data)||void 0===n?void 0:n.queuedCount.__typename)!=="Runs"||(null===(e=G.data)||void 0===e?void 0:e.queuedCount.count)===0}):"in-progress"===A?(0,s.jsx)(M,{refetch:X.refetch,filter:{statuses:Array.from(Q.Ys)},disabled:(null===(t=G.data)||void 0===t?void 0:t.inProgressCount.__typename)!=="Runs"||(null===(r=G.data)||void 0===r?void 0:r.inProgressCount.count)===0}):void 0]})};(0,_.Px)();var a=(0,u._)((0,Y.oD)(),2),x=a[0],b=a[1],q=(0,Y.VH)(x),E=(0,J.l)({nextCursorForResult:function(n){var e;if("Runs"===n.pipelineRunsOrError.__typename)return null===(e=n.pipelineRunsOrError.results[24])||void 0===e?void 0:e.id},getResultArray:function(n){return n&&"Runs"===n.pipelineRunsOrError.__typename?n.pipelineRunsOrError.results:[]},variables:{filter:q},query:ne,pageSize:25}),P=E.queryResult,F=E.paginationProps,T=(0,R.C4)(P,R.dT),A=(0,I.Qf)(x),$="all"!==A,O=(0,u._)(g()(x,function(n){return"status"===n.token}),2),H=O[0],U=O[1],D=y.useCallback(function(n){$?b((0,o._)(H).concat((0,o._)(n))):b(n)},[b,$,H]),V=y.useCallback(function(n){var e=(0,c.HY)(n);U.some(function(n){return(0,c.HY)(n)===e})||D((0,o._)(U).concat([n]))},[U,D]),Z=y.useMemo(function(){var n=["tag","snapshotId","id","job","pipeline","backfill"];return $||n.push("status"),n},[$]),L=y.useMemo(function(){return $?x.filter(function(n){return"status"!==n.token}):x},[x,$]),W=(0,I.zc)(q),B=W.tabs,G=W.queryResult,K=(0,R.C4)(G,R.dT),X=(0,R.V5)(K,T),nn=(0,Y.Vv)({tokens:L,onChange:D,enabledFilters:Z}),nt=nn.button,nr=nn.activeFiltersJsx,nu=(0,u._)((e=(n=(0,u._)(y.useState(null),2))[0],t=n[1],y.useLayoutEffect(function(){t(function(n){return null===n?document.createElement("div"):n})},[]),[e?(0,C.createPortal)(nt,e):null,e?(0,s.jsx)(w,{node:e}):null]),2),ni=nu[0],no=nu[1];return(0,s.jsxs)(d.T,{children:[(0,s.jsx)(f.m,{title:(0,s.jsx)(h.X6,{children:"Runs"}),right:(0,s.jsx)(R.xi,{refreshState:X})}),ni,(0,s.jsx)(z.Lw.Provider,{value:{refetch:P.refetch},children:(0,s.jsx)(j.g,{queryResult:P,allowStaleData:!0,renderError:function(n){var e=!!((null==n?void 0:n.networkError)&&"statusCode"in n.networkError&&400===n.networkError.statusCode);return(0,s.jsxs)(l.x,{flex:{direction:"column",gap:32},padding:{vertical:8,left:24,right:12},children:[i(),(0,s.jsx)(p.t,{icon:"warning",title:e?"Invalid run filters":"Unexpected error",description:e?"The specified run filters are not valid. Please check the filters and try again.":"An unexpected error occurred. Check the console for details."})]})},children:function(n){var e=n.pipelineRunsOrError;return"Runs"!==e.__typename?(0,s.jsx)(l.x,{padding:{vertical:64},children:(0,s.jsx)(p.t,{icon:"error",title:"Query Error",description:e.message})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(k.Y,{$top:0,children:(0,s.jsx)(N.AL,{runs:e.results.slice(0,25),onAddTag:V,filter:q,actionBarComponents:i(),belowActionBarComponents:"queued"===A||nr.length?(0,s.jsxs)(s.Fragment,{children:["queued"===A&&(0,s.jsx)(S,{}),nr.length>0&&(0,s.jsxs)(s.Fragment,{children:[nr,(0,s.jsx)(v.Z,{onClick:function(){return D([])},children:"Clear all"})]})]}):null})}),e.results.length>0?(0,s.jsx)("div",{style:{marginTop:"16px"},children:(0,s.jsx)(m.pI,(0,r._)({},F))}):null]})}})})]})},nn=X,ne=(0,a.Ps)(K(),N.ZZ,b.B)},65767:function(n,e,t){"use strict";t.d(e,{l:function(){return c}});var r=t(85333),u=t(6692),i=t(58467),o=t(82550),s=t(40794),a=t(2784),l=t(71277);function c(n){var e=(0,i._)(a.useState(function(){return[]}),2),t=e[0],c=e[1],d=(0,i._)((0,l.q)({queryKey:"cursor"}),2),f=d[0],h=d[1],p=(0,u._)((0,r._)({},n.variables),{cursor:f,limit:n.pageSize+1}),v=(0,s.a)(n.query,{skip:n.skip,variables:p,notifyOnNetworkStatusChange:!0}),m={hasPrevCursor:!!f,hasNextCursor:n.getResultArray(v.data).length===n.pageSize+1,popCursor:function(){var n=(0,o._)(t);h(n.pop()),c(n)},advanceCursor:function(){f&&c(function(n){return(0,o._)(n).concat([f])});var e=v.data&&n.nextCursorForResult(v.data);e&&h(e)},reset:function(){c([]),h(void 0)}};return{queryResult:v,paginationProps:m}}},19358:function(n,e,t){"use strict";t.d(e,{Y:function(){return o}});var r=t(73235),u=t(86412);function i(){var n=(0,r._)(["\n  thead tr {\n    position: sticky;\n    top: ","px;\n    background-color: ",";\n    z-index: 1;\n  }\n\n  /**\n   * Safari won't render a box-shadow on the `tr` and we don't want an inset\n   * box-shadow on `th` elements because it will create a double-border on the\n   * bottom of the `thead` in the non-stuck state.\n   *\n   * We therefore render an absoulutely-positioned keyline on the bottom of the\n   * `th` elements. This will appear as a border in the stuck state, and will\n   * overlap the top box-shadow of the first row in the non-stuck state.\n   */\n  thead tr th {\n    position: relative;\n  }\n\n  thead tr th::after {\n    content: '';\n    display: block;\n    height: 1px;\n    background-color: ",";\n    position: absolute;\n    bottom: -1px;\n    left: 0;\n    right: 0;\n  }\n"],["\n  thead tr {\n    position: sticky;\n    top: ","px;\n    background-color: ",";\n    z-index: 1;\n  }\n\n  /**\n   * Safari won't render a box-shadow on the \\`tr\\` and we don't want an inset\n   * box-shadow on \\`th\\` elements because it will create a double-border on the\n   * bottom of the \\`thead\\` in the non-stuck state.\n   *\n   * We therefore render an absoulutely-positioned keyline on the bottom of the\n   * \\`th\\` elements. This will appear as a border in the stuck state, and will\n   * overlap the top box-shadow of the first row in the non-stuck state.\n   */\n  thead tr th {\n    position: relative;\n  }\n\n  thead tr th::after {\n    content: '';\n    display: block;\n    height: 1px;\n    background-color: ",";\n    position: absolute;\n    bottom: -1px;\n    left: 0;\n    right: 0;\n  }\n"]);return i=function(){return n},n}var o=t(35505).ZP.div.withConfig({componentId:"sc-518cab7f-0"})(i(),function(n){var e=n.$top;return void 0===e?0:e},u.w.White,u.w.KeylineGray)}}]);
//# sourceMappingURL=63.2c240513e520a4ed.js.map