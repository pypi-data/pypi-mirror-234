# See /docs/architecture/networking.md

version: "3.8"

services:
  gama_ui:
    ports:
      - "3000:3000"
    networks:
      - vessel

  gama_chart_tiler:
    ports:
      - 3001:8080
    networks:
      - vessel

  gama_chart_api:
    ports:
      - 3002:3000
    networks:
      - vessel

  gama_vessel:
    network_mode: service:gama_tailscale

  gama_greenstream:
    network_mode: service:gama_tailscale

  gama_tailscale:
    image: mvisonneau/tailscale
    container_name: gama_tailscale
    restart: always
    privileged: true
    cap_add:
      - NET_ADMIN
      - SYS_MODULE
    devices:
      - /dev/net/tun
    environment:
      - TZ=Australia/Sydney
      - TAILSCALE_HOSTNAME=educat-docker
      - TAILSCALE_AUTH_KEY
      - TAILSCALE_LOGIN_SERVER=https://vpn.greenroomrobotics.com
    volumes:
      - /var/run/dbus/system_bus_socket:/var/run/dbus/system_bus_socket
    networks:
      - vessel

networks:
  vessel: