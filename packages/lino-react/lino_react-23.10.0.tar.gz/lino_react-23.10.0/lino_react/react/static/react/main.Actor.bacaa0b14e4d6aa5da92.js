"use strict";(self.webpackChunklino_react=self.webpackChunklino_react||[]).push([[783],{1905:(e,t,n)=>{n.r(t),n.d(t,{linoResolveGetter:()=>H,name:()=>F});var r={};n.r(r),n.d(r,{linoResolveGetter:()=>A,name:()=>E});var o={};n.r(o),n.d(o,{linoResolveGetter:()=>R,name:()=>B});var a={};n.r(a),n.d(a,{linoResolveGetter:()=>T,name:()=>O});var i={};n.r(i),n.d(i,{linoResolveGetter:()=>G,name:()=>K});var s={};n.r(s),n.d(s,{linoResolveGetter:()=>$});var l=n(1441),c=n(4085),u=n(9238),p=n(2367),d=n(628),_=n(5726),m=n(673),f=n(798),h=n.n(f),v=n(1674),b=n(3223),y=n(2280),w=n(4439);function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var o=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,p.Z)(this,n)}}var E="LoadingMask";function k(){return(k=(0,m.Z)(h().mark((function e(){var t,n,r,o,a,i,s,p,d,m,f;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=function(e){var t=e.parent.state.loading||e.parent.state.refresh||e.parent.state.site_loading;return o.createElement(p,{mode:"indeterminate",className:t?"":"lino-transparent",style:{height:"5px"}})},d=function(e){return o.createElement("div",{style:{height:"100vh",width:"100vw",background:"#1b2c3159",textAlign:"center",position:"fixed",top:"0",left:"0",bottom:"0",right:"0",zIndex:"99999"}},o.createElement(s,{animationDuration:"1s",className:"vertical-center",strokeWidth:"50",style:{borderRadius:"50%",overflow:"hidden",width:"150px",height:"150px"}}))},t=window.iPool,e.next=5,t.resolve("react",["default","Component"]);case 5:return n=e.sent,r=(0,_.Z)(n,2),o=r[0],a=r[1],e.next=11,t.resolve("prop-types","default");case 11:return i=e.sent,e.next=14,t.resolve("primereact/progressspinner","ProgressSpinner");case 14:return s=e.sent,e.next=17,t.resolve("primereact/progressbar","ProgressBar");case 17:return p=e.sent,(m=function(e){(0,u.Z)(n,e);var t=g(n);function n(){var e;return(0,l.Z)(this,n),(e=t.call(this)).state={},e}return(0,c.Z)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=(e.masking,e.children),n=e.mask,r=e.fillHeight,a=e.backgroundColor,i={position:"relative"};return r?i.height="100%":i.overflow="hidden",o.createElement("div",{style:i},o.createElement("div",{className:"lino-loading-mask",style:{display:n?"block":"none",backgroundColor:a}},o.createElement("div",{style:{position:"absolute",top:"50%",right:"50%",transform:"translate(50%,-50%)"}},o.createElement(s,null)," ")),t)}}]),n}(a)).propTypes={masking:i.element,mask:i.bool,fillHeight:i.bool,backgroundColor:i.string},m.defaultProps={fillHeight:!1,backgroundColor:"#007ad9"},e.abrupt("return",[m,f,d]);case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A={resolveGetter:function(){return k.apply(this,arguments)},resolveNames:["LoadingMask","LinoProgressBar","LinoLoadMask"]},C=n(1566),M=n(3379),P=n.n(M),x=n(3698);function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var o=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,p.Z)(this,n)}}P()(x.Z,{insert:"head",singleton:!1}),x.Z.locals;var B="AppMenu";function D(){return D=(0,m.Z)(h().mark((function e(){var t,n,r,o,a,i,s,p,d,m;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.iPool,e.next=3,t.resolve("react",["default","Component"]);case 3:return n=e.sent,r=(0,_.Z)(n,2),o=r[0],a=r[1],e.next=9,t.resolve("prop-types","default");case 9:return i=e.sent,e.next=12,t.resolve("classnames","default");case 12:return s=e.sent,e.next=15,t.resolve("./LinoUtils","detailDirty");case 15:return p=e.sent,(d=function(e){(0,u.Z)(n,e);var t=I(n);function n(e){var r;return(0,l.Z)(this,n),(r=t.call(this,e)).state={activeIndex:null},r}return(0,c.Z)(n,[{key:"onMenuItemClick",value:function(e,t,n){if(t.disabled)return e.preventDefault(),!0;if(t.command)if(e.ctrlKey){var r=window.open(document.URL),o=0;!function n(){if(r.hasOwnProperty("App")&&!r.App.state.site_loading){var a=null;!function e(n){n.every((function(n){if(null!==a)return!1;if(n.hasOwnProperty("items"))e(n.items);else if(n.id===t.id)return a=n,!1;return!0}))}(r.App.state.menu_data),r.command=a.command,r.command({originalEvent:e,item:a})}else{if(o>20)return;o+=1,setTimeout((function(){return n()}),100)}}()}else p(null)?window.Detail.onDirtyLeave({},"INAPP",t.command,{originalEvent:e,item:t}):t.command({originalEvent:e,item:t});!t.items&&t.url||e.preventDefault(),n===this.state.activeIndex?this.setState({activeIndex:null}):this.setState({activeIndex:n}),this.props.onMenuItemClick&&this.props.onMenuItemClick({originalEvent:e,item:t})}},{key:"render",value:function(){var e=this,t=this.props.items&&this.props.items.map((function(t,r){if("is_a_seperator"===t)return o.createElement("hr",{key:r});var a=e.state.activeIndex===r,i=s(t.badgeStyleClass,{"active-menuitem":a});i+=" l-menuitem",t.id===e.props.activeElemId&&(i+=" l-linked-menu");var l=t.badge&&o.createElement("span",{className:"menuitem-badge"},t.badge),c=t.items&&o.createElement("i",{className:"pi pi-fw pi-angle-down menuitem-toggle-icon"});return o.createElement("li",{className:i,key:r,id:t.id},t.items&&!0===e.props.root&&o.createElement("div",{className:"arrow"}),o.createElement("a",{href:t.url,onClick:function(n){e.onMenuItemClick(n,t,r)},target:t.target},o.createElement("i",{className:t.icon}),o.createElement("span",null,t.label),c,l),o.createElement(n,{activeElemId:e.props.activeElemId,items:t.items,onMenuItemClick:e.props.onMenuItemClick}))}));return t?o.createElement("ul",{className:this.props.className},t):null}}]),n}(a)).defaultProps={className:null,items:null,onMenuItemClick:null,root:!1},d.propTypes={className:i.string,items:i.array,onMenuItemClick:i.func,root:i.bool},(m=function(e){(0,u.Z)(n,e);var t=I(n);function n(e){var r;return(0,l.Z)(this,n),(r=t.call(this,e)).state={navKeys:[37,38,39,13,40],activeNavKeys:!1},r.data={elemStore:window.App.data.miStore,activeElemId:null},r.onKeyDown=r.onKeyDown.bind((0,C.Z)(r)),r.onMenuTrigger=r.onMenuTrigger.bind((0,C.Z)(r)),r.walkDown=r.walkDown.bind((0,C.Z)(r)),r.walkUp=r.walkUp.bind((0,C.Z)(r)),r.walkRight=r.walkRight.bind((0,C.Z)(r)),r.walkLeft=r.walkLeft.bind((0,C.Z)(r)),r}return(0,c.Z)(n,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.onKeyDown)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.onKeyDown)}},{key:"matchId",value:function(e){return function(t){return t.id===e}}},{key:"walkDown",value:function(e,t){var n=this,r=t,o=e.slice(-1)[0];e.forEach((function(a){if(a!==o){var i=r.findIndex(n.matchId(a));r=r[i].items}else{var s=document.getElementById(a);s.classList.remove("active-menuitem");var l=r.findIndex(n.matchId(a));l<r.length-1?(s.classList.remove("l-selected-menu"),(s=document.getElementById(r[l+1].id)).classList.add("l-selected-menu"),s.getBoundingClientRect().bottom-window.innerHeight<0&&s.scrollIntoView({block:"center",behaviour:"smooth"})):e.length>1&&(document.getElementById(e.slice(-2)[0]).getElementsByTagName("a")[0].click(),s.classList.remove("l-selected-menu"),e=e.slice(0,-1),n.walkDown(e,t))}}))}},{key:"walkUp",value:function(e,t){var n=this,r=t;e.forEach((function(o){if(o!==e.slice(-1)[0]){var a=r.findIndex(n.matchId(o));r=r[a].items}else{var i=document.getElementById(o);i.classList.remove("active-menuitem");var s=r.findIndex(n.matchId(o));0!==s?(i.classList.remove("l-selected-menu"),(i=document.getElementById(r[s-1].id)).classList.add("l-selected-menu"),i.getBoundingClientRect().top<80&&i.scrollIntoView({block:"center",behaviour:"smooth"})):e.length>1&&(document.getElementById(e.slice(-2)[0]).getElementsByTagName("a")[0].click(),i.classList.remove("l-selected-menu"),e=e.slice(0,-1),n.walkUp(e,t))}}))}},{key:"walkRight",value:function(e,t){var n=this,r=t,o=Array.from(document.getElementsByClassName("l-selected-menu"));o.length&&o[0].classList.remove("l-selected-menu"),e.forEach((function(t){var o=r.findIndex(n.matchId(t));if(t!==e.slice(-1)[0])r=r[o].items;else{n.data.activeElemId=t;var a,i=document.getElementById(r[o].id);r[o].items&&(a=document.getElementById(r[o].items[0].id)).classList.add("l-selected-menu"),i.getElementsByTagName("a")[0].click(),a||(i.classList.add("l-selected-menu"),n.onMenuTrigger())}}))}},{key:"walkLeft",value:function(e,t){if(e.length>1){var n=document.getElementById(e.slice(-1)[0]);n.classList.remove("l-selected-menu"),n.classList.remove("active-menuitem"),(n=document.getElementById(e.slice(-2)[0])).getElementsByTagName("a")[0].click(),n.classList.add("l-selected-menu")}}},{key:"onMenuTrigger",value:function(){if(this.state.activeNavKeys)window.postMessage("ArrowsReleased","*"),Array.from(document.getElementsByClassName("l-selected-menu")).forEach((function(e){return e.classList.remove("l-selected-menu")})),Array.from(document.getElementsByClassName("active-menuitem")).forEach((function(e){return e.classList.remove("active-menuitem")}));else{window.App.state.staticMenuInactive&&window.App.onToggleMenu(),window.postMessage("ArrowsTaken","*");var e=Array.from(document.getElementsByClassName("active-menuitem"));e.length?e.slice(-1)[0].classList.add("l-selected-menu"):document.getElementById(this.data.elemStore[0].id).classList.add("l-selected-menu")}this.setState({activeNavKeys:!this.state.activeNavKeys})}},{key:"onKeyDown",value:function(e){var t=this;if((""===document.activeElement.value||void 0===document.activeElement.value)&&(77===e.keyCode&&e.altKey||this.state.activeNavKeys)){if(77===e.keyCode&&e.altKey){var n=!1;if(this.state.activeNavKeys&&(n=!0),this.onMenuTrigger(),n)return}if(this.state.navKeys.includes(e.keyCode)){e.preventDefault();var r=[],o=!1,a=this.data.elemStore,i=a;if(Array.from(document.getElementsByClassName("active-menuitem")).forEach((function(e){if(o)e.classList.remove("active-menuitem");else{var n=i.findIndex(t.matchId(e.id));n>=0?(i=i[n].items,r.push(e.id),void 0===i&&(o=!0)):e.classList.remove("active-menuitem")}})),r.length||r.push(a[0].id),r.length){var s=document.getElementById(r.slice(-1)[0]),l=Array.from(s.getElementsByClassName("l-selected-menu"));l.length?r.push(l[0].id):r.length>1?(s=document.getElementById(r.slice(-2)[0]),(l=Array.from(s.getElementsByClassName("l-selected-menu"))).length&&(r=r.slice(0,-1)).push(l[0].id)):(l=Array.from(document.getElementsByClassName("l-selected-menu"))).length&&(r=r.slice(0,-1)).push(l[0].id)}40===e.keyCode?this.walkDown(r,a):38===e.keyCode?this.walkUp(r,a):39===e.keyCode||13===e.keyCode?this.walkRight(r,a):37===e.keyCode&&this.walkLeft(r,a)}}}},{key:"render",value:function(){return o.createElement("div",{className:"menu"},o.createElement(d,{activeElemId:this.data.activeElemId,items:this.props.model,className:"layout-main-menu",onMenuItemClick:this.props.onMenuItemClick,root:!0}))}}]),n}(a)).defaultProps={model:null,onMenuItemClick:null},m.propTypes={model:i.array,onMenuItemClick:i.func},e.abrupt("return",[m]);case 23:case"end":return e.stop()}}),e)}))),D.apply(this,arguments)}var R={resolveGetter:function(){return D.apply(this,arguments)},resolveNames:["AppMenu"]};function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var o=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,p.Z)(this,n)}}var O="AppInlineProfile";function Z(){return(Z=(0,m.Z)(h().mark((function e(){var t,n,r,o,a,i,s,p,d,m;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.iPool,e.next=3,t.resolve("react",["default","Component"]);case 3:return n=e.sent,r=(0,_.Z)(n,2),o=r[0],a=r[1],e.next=9,t.resolve("prop-types","default");case 9:return i=e.sent,e.next=12,t.resolve("primereact/overlaypanel","OverlayPanel");case 12:return s=e.sent,e.next=15,t.resolve("primereact/card","Card");case 15:return p=e.sent,e.next=18,t.resolve("primereact/button","Button");case 18:return d=e.sent,(m=function(e){(0,u.Z)(n,e);var t=L(n);function n(){var e;return(0,l.Z)(this,n),(e=t.call(this)).state={expanded:!1},e.onClick=e.onClick.bind((0,C.Z)(e)),e}return(0,c.Z)(n,[{key:"onClick",value:function(e){this.pop&&this.pop.toggle(e),this.setState({expanded:!this.state.expanded}),e.preventDefault()}},{key:"renderActAsOverLay",value:function(){var e=this,t=this.props,n=t.act_as_title_text,r=t.act_as_subtext;return o.createElement(s,{ref:function(t){return e.op=t},appendTo:this.props.authAppendTo,className:"l-actas"},o.createElement(p,{title:n,subTitle:r},this.props.authorities.map((function(t){return o.createElement(o.Fragment,{key:t[0]},o.createElement(d,{label:t[1],onClick:function(n){e.props.onAuthoritiesSelect(t),e.op.hide()}}),o.createElement("br",null))}))))}},{key:"render",value:function(){var e=this,t=this.props,n=t.username,r=t.su_name,a=t.su_id,i=this.props,l=i.act_as_button_text,c=i.act_as_self_text,u=i.my_setting_text;n=r?"".concat(n," acting as ").concat(r):n;var p=window.App.data.selectedLanguage||window.App.state.user_settings.lang;return o.createElement("div",{className:"profile"},o.createElement(d,{label:window.App.state.site_data.languages[p],onClick:function(t){return e.lsop.toggle(t)}}),o.createElement("span",null," | "),o.createElement(s,{ref:function(t){return e.lsop=t}},Object.keys(window.App.state.site_data.languages).filter((function(e){return e!=p})).map((function(e){return o.createElement(o.Fragment,{key:e},o.createElement(d,{label:window.App.state.site_data.languages[e],onClick:function(t){window.App.data.selectedLanguage=e,window.App.fetch_user_settings(a,!1,!0)}}),o.createElement("br",null))}))),this.props.logged_in?o.createElement(o.Fragment,null,o.createElement(d,{icon:"pi pi-cog",iconPos:"right",label:n,onClick:this.onClick}),o.createElement(s,{ref:function(t){return e.pop=t}},o.createElement(d,{icon:"pi pi-power-off",label:"Sign out",onClick:this.props.onSignOutIn}),o.createElement("br",null),a&&o.createElement(d,{icon:"pi pi-user",label:c,onClick:this.props.onActAsSelf}),o.createElement("br",null),this.props.authorities.length>0&&o.createElement(d,{icon:"pi pi-users",label:l,onClick:function(t){t.target=e.actAsEl,e.op.toggle(t)},ref:function(t){return e.actAsEl=t}}),o.createElement("br",null),o.createElement(d,{icon:"pi pi-sliders-v",label:u,onClick:this.props.onMysettings})),this.renderActAsOverLay()):o.createElement(o.Fragment,null,o.createElement(d,{icon:"pi pi-power-off",label:"Sign in",onClick:this.props.onSignOutIn}),o.createElement(d,{icon:"pi pi-plus-circle",label:"Create account",onClick:this.props.createAccount})))}}]),n}(a)).propTypes={logged_in:i.bool,username:i.string.isRequired,onSignOutIn:i.func.isRequired,authorities:i.array,onAuthoritiesSelect:i.func,onActAsSelf:i.func,authAppendTo:i.instanceOf(Element),su_name:i.string,su_id:i.oneOfType([i.number,i.instanceOf(void 0)]),act_as_button_text:i.string,act_as_title_text:i.string,act_as_subtext:i.string,act_as_self_text:i.string,my_setting_text:i.string,onMysettings:i.func.isRequired},m.defaultProps={authorities:[]},e.abrupt("return",{AppInlineProfile:m});case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T={resolveGetter:function(){return Z.apply(this,arguments)},resolveNames:["AppInlineProfile"]},N=n(8554),W=n(5790);function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var o=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,p.Z)(this,n)}}P()(W.Z,{insert:"head",singleton:!1}),W.Z.locals;var K="AppTopbar";function U(){return(U=(0,m.Z)(h().mark((function e(){var t,n,r,o,a,i,s,p,d;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.iPool,e.next=3,t.resolve("react",["default","Component"]);case 3:return n=e.sent,r=(0,_.Z)(n,2),o=r[0],a=r[1],e.next=9,t.resolve("prop-types","default");case 9:return i=e.sent,window.iPool=t,e.next=13,t.resolve("classnames","default");case 13:return s=e.sent,e.next=16,t.resolve("./AppInlineProfile","AppInlineProfile");case 16:return p=e.sent,(d=function(e){(0,u.Z)(n,e);var t=S(n);function n(){var e;return(0,l.Z)(this,n),(e=t.call(this)).renderChatButton=e.renderChatButton.bind((0,C.Z)(e)),e}return(0,c.Z)(n,[{key:"componentDidMount",value:function(){setTimeout(window.App.handleZoom,1e3)}},{key:"renderChatButton",value:function(){return o.createElement("a",{onClick:this.props.onChatButton,ref:function(e){return window.App.chatButton=e}},o.createElement("span",{className:s("layout-topbar-icon pi pi-comments",{"no-ws":!this.props.WS})}))}},{key:"render",value:function(){var e;return window.App.data.themeName,o.createElement("div",{ref:function(e){return window.App.tbContainer=e},className:"layout-topbar clearfix"},o.createElement("a",{className:"layout-menu-button",onClick:this.props.onToggleMenu},o.createElement("span",{className:"pi pi-bars"})),o.createElement("a",{className:"layout-home-button",onClick:this.props.onHomeButton},o.createElement("span",{className:"pi pi-home"})),window.App.state.site_data.editing_frontend&&o.createElement("a",{className:"layout-home-button",onClick:function(e){var t="_self";e.ctrlKey&&(t="_blank"),window.open(location.origin,t)}},o.createElement("span",{className:"pi pi-globe"})),o.createElement("div",{className:"layout-topbar-icons",style:{display:"inline"}},!window.App.state.site_loading&&!window.App.state.site_data.no_user_model&&o.createElement(p,(e={username:window.App.state.user_settings.username,logged_in:window.App.state.user_settings.logged_in,authorities:window.App.state.user_settings.authorities,onActAsSelf:function(){return window.App.onAuthoritiesSelect([void 0])},su_id:window.App.state.su_id,su_name:window.App.state.user_settings.su_name,act_as_subtext:window.App.state.user_settings.act_as_subtext,act_as_title_text:window.App.state.user_settings.act_as_title_text,act_as_button_text:window.App.state.user_settings.act_as_button_text,act_as_self_text:window.App.state.user_settings.act_as_self_text},(0,N.Z)(e,"act_as_self_text",window.App.state.user_settings.act_as_self_text),(0,N.Z)(e,"onAuthoritiesSelect",window.App.onAuthoritiesSelect),(0,N.Z)(e,"my_setting_text",window.App.state.user_settings.my_setting_text),(0,N.Z)(e,"onSignOutIn",(function(e){return window.App.onSignOutIn(e)})),(0,N.Z)(e,"createAccount",window.App.createAccount),(0,N.Z)(e,"authAppendTo",window.App.topDiv),(0,N.Z)(e,"onMysettings",(function(e){return window.App.onMysettings(e)})),e)),this.props.useChat&&this.renderChatButton()))}}]),n}(a)).defaultProps={onToggleMenu:null,unseenCount:0},d.propTypes={onToggleMenu:i.func.isRequired,onHomeButton:i.func.isRequired,onChatButton:i.func,useChat:i.bool,WS:i.bool,unseenCount:i.number},e.abrupt("return",{AppTopbar:d});case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var G={resolveGetter:function(){return U.apply(this,arguments)},resolveNames:["AppTopbar"]};function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var o=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,p.Z)(this,n)}}function j(){return(j=(0,m.Z)(h().mark((function e(){var t,n,r,o,a,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.iPool,e.next=3,t.resolve("react","default");case 3:return n=e.sent,e.next=6,t.resolve("whatwg-fetch","fetch");case 6:return r=e.sent,e.next=9,t.resolve("./LinoUtils","getCacheKey");case 9:return o=e.sent,a=n.createContext({}),i=function(e){(0,u.Z)(i,e);var t=q(i);function i(){var e;return(0,l.Z)(this,i),(e=t.call(this)).state={loaded:!1,actorData:null},e}return(0,c.Z)(i,[{key:"getData",value:function(e,t){var n=window.localStorage,a=window.App.state.user_settings,i=a.user_type,s=a.lang,l=window.App.data.selectedLanguage||s,c=window.App.state.user_settings.su_user_type,u=o(e),p=n.getObject(u);if(p)t(p);else{var d="/media/cache/json/";d+=window.App.state.site_data.no_user_model?"Lino_".concat(e,"_").concat(l,".json"):"Lino_".concat(e,"_").concat(c||i,"_").concat(l,".json"),d+="?v=".concat(Math.round(1e6*Math.random()).toString()),r(d).then(window.App.handleAjaxResponse).then((function(e){n.setObject(u,e),t(e)}))}}},{key:"componentDidMount",value:function(){var e=this;void 0===this.props.actorId?this.setState({loaded:!0}):this.getData(this.props.actorId,(function(t){e.setState({loaded:!0,actorData:t})}))}},{key:"render",value:function(){return void 0===this.props.actorId?this.props.children:n.createElement(a.Provider,{value:this.state.actorData},this.state.loaded&&this.props.children)}}]),i}(n.Component),e.abrupt("return",{ActorData:i,ActorContext:a});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Storage.prototype.setObject=function(e,t){this.setItem(e,JSON.stringify(t))},Storage.prototype.getObject=function(e){var t=this.getItem(e);return t&&JSON.parse(t)};var $={resolveGetter:function(){return j.apply(this,arguments)},resolveNames:["ActorData","ActorContext"]};function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var o=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,p.Z)(this,n)}}var F="Actor";function V(){return(V=(0,m.Z)(h().mark((function e(){var t,p,d,m,f,g,E,k,A,C,M,P,x,I,B,D,R,L,O,Z,T,N,W,S,K,U,G,q,j,$,F,V,H,J,Y,Q,X,ee,te,ne;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=window.iPool).addModule("primereact/card",v),t.addModule("primereact/dialog",b),t.addModule("primereact/splitbutton",y),t.add("./LinoBbar",w),t.add("./LoadingMask",r),t.add("./AppMenu",o),t.add("./AppInlineProfile",a),t.add("./AppTopbar",i),t.add("./SiteContext",s),t.add("./LinoComponents",Promise.all([n.e(268),n.e(598),n.e(321)]).then(n.bind(n,8727))),t.add("./BodyComponents",n.e(600).then(n.bind(n,8616))),t.add("./primereact/body_chunk",Promise.all([n.e(174),n.e(145)]).then(n.bind(n,173))),t.add("./primereact/component_chunk",Promise.all([n.e(477),n.e(921)]).then(n.bind(n,6604))),e.next=16,t.resolve("./primereact/body_chunk",["primereact_column","primereact_datatable","primereact_togglebutton","primereact_dataview","primereact_galleria","primereact_dropdown","primereact_paginator","primereact_slider","primereact_autocomplete","primereact_inputtext","primereact_multiselect"]);case 16:return p=e.sent,d=(0,_.Z)(p,11),m=d[0],f=d[1],g=d[2],E=d[3],k=d[4],A=d[5],C=d[6],M=d[7],P=d[8],x=d[9],I=d[10],t.addModule("primereact/autocomplete",P),t.addModule("primereact/inputtext",x),t.addModule("primereact/multiselect",I),t.addModule("primereact/togglebutton",g),t.addModule("primereact/dropdown",A),t.addModule("primereact/paginator",C),t.addModule("primereact/slider",M),t.addModule("primereact/dataview",E),t.addModule("primereact/galleria",k),t.addModule("primereact/column",m),t.addModule("primereact/datatable",f),e.next=42,t.resolve("./primereact/component_chunk",["primereact_tabview","primereact_panel","primereact_checkbox","primereact_fieldset","primereact_password","primereact_calendar","primereact_editor","primereact_fileupload"]);case 42:return B=e.sent,D=(0,_.Z)(B,8),R=D[0],L=D[1],O=D[2],Z=D[3],T=D[4],N=D[5],W=D[6],S=D[7],t.addModule("primereact/tabview",R),t.addModule("primereact/panel",L),t.addModule("primereact/checkbox",O),t.addModule("primereact/fieldset",Z),t.addModule("primereact/dropdown",A),t.addModule("primereact/password",T),t.addModule("primereact/calendar",N),t.addModule("primereact/editor",W),t.addModule("./primereact/fileupload",S),e.next=63,t.resolve("./BodyComponents",["DashboardItemsModule","LinoDialogModule","LinoBodyModule"]);case 63:return K=e.sent,U=(0,_.Z)(K,3),G=U[0],q=U[1],j=U[2],t.add("./DashboardItems",G),t.add("./LinoDialog",q),t.add("./LinoBody",j),e.next=73,t.resolve("react",["default","Component"]);case 73:return $=e.sent,F=(0,_.Z)($,2),V=F[0],H=F[1],e.next=79,t.resolve("weak-key","default");case 79:return e.sent,e.next=82,t.resolve("prop-types","default");case 82:return J=e.sent,e.next=85,t.resolve("query-string","default");case 85:return e.sent,e.next=88,t.resolve("./LinoBody","LinoBody");case 88:return Y=e.sent,e.next=91,t.resolve("./SiteContext",["ActorData","ActorContext"]);case 91:return Q=e.sent,X=(0,_.Z)(Q,2),ee=X[0],te=X[1],(ne=function(e){(0,u.Z)(n,e);var t=z(n);function n(e){var r;return(0,l.Z)(this,n),(r=t.call(this,e)).state={code_expired:r.expiredVerificationCode()},r}return(0,c.Z)(n,[{key:"expiredVerificationCode",value:function(){if(window.App.state.user_settings.code_expiry){var e=(new Date).getTime()/1e3;return window.App.state.user_settings.code_expiry<e}}},{key:"componentDidUpdate",value:function(){!1===this.state.code_expired&&this.expiredVerificationCode()&&this.setState({code_expired:!0})}},{key:"render",value:function(){var e=this;return V.createElement("div",{ref:function(t){return e.container=t}},V.createElement(ee,{key:this.props.actorId+this.props.su,actorId:this.props.packId+"."+this.props.actorId},V.createElement(te.Consumer,null,(function(t){return V.createElement(V.Fragment,null,window.App.state.user_settings.require_verification&&V.createElement("div",{style:{textAlign:"center"}},e.state.code_expired?V.createElement("p",null,"Your verification code has expired.",V.createElement("span",{onClick:function(e){window.App.handleVerification("send_welcome_email")},className:"l-span-clickable l-btn-inline"},"Resend")):V.createElement("p",null,"We have sent an email to ",window.App.state.user_settings.email,". Please ",V.createElement("span",{onClick:function(e){window.App.handleVerification("verify")},className:"l-span-clickable l-btn-inline"},"Confirm"))),V.createElement(Y,{ref:window.App.setRpRef,router:e.props.router,actorId:e.props.actorId,packId:e.props.packId,key:e.props.packId+"."+e.props.actorId,actorData:t,mk:e.props.mk,mt:e.props.mt,parentBody:!0,widthInCh:e.container.offsetWidth/e.chInPx.offsetWidth}))}))),V.createElement("div",{ref:function(t){return e.chInPx=t},style:{width:"1ch",visibility:"hidden"}}))}}]),n}(H)).propTypes={router:J.object,actorId:J.string,packId:J.string,su:J.string},ne.defaultProps={},e.abrupt("return",[ne]);case 99:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var H={resolveGetter:function(){return V.apply(this,arguments)},resolveNames:["Actor"]}},4439:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{name:()=>name,linoResolveGetter:()=>linoResolveGetter});var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(6676),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1441),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(4085),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(1566),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(9238),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(2367),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(628),_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(5726),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(673),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(798),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),_LinoBbar_css__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(5817);function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,r=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_1__.Z)(e);if(t){var o=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_1__.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__.Z)(this,n)}}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var name="LinoBbar";function linoBbarGetter(){return _linoBbarGetter.apply(this,arguments)}function _linoBbarGetter(){return _linoBbarGetter=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee(){var iPool,_yield$iPool$resolve,_yield$iPool$resolve2,React,Component,PropTypes,Button,SplitButton,LinoLoadMask,detailDirty,LinoBbar;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return iPool=window.iPool,_context.next=3,iPool.resolve("react",["default","Component"]);case 3:return _yield$iPool$resolve=_context.sent,_yield$iPool$resolve2=(0,_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_5__.Z)(_yield$iPool$resolve,2),React=_yield$iPool$resolve2[0],Component=_yield$iPool$resolve2[1],_context.next=9,iPool.resolve("prop-types","default");case 9:return PropTypes=_context.sent,_context.next=12,iPool.resolve("primereact/button","Button");case 12:return Button=_context.sent,_context.next=15,iPool.resolve("primereact/splitbutton","SplitButton");case 15:return SplitButton=_context.sent,_context.next=18,iPool.resolve("./LoadingMask","LinoLoadMask");case 18:return LinoLoadMask=_context.sent,_context.next=21,iPool.resolve("./LinoUtils","detailDirty");case 21:return detailDirty=_context.sent,LinoBbar=function(_Component){(0,_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6__.Z)(LinoBbar,_Component);var _super=_createSuper(LinoBbar);function LinoBbar(e){var t;return(0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_7__.Z)(this,LinoBbar),(t=_super.call(this,e)).state={overflowShow:!1,width:void 0,loadMask:!1},t.data={editorDirty:!1},t.action2buttonProps=t.action2buttonProps.bind((0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__.Z)(t)),t.render_buttons=t.render_buttons.bind((0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__.Z)(t)),t.render_overflow=t.render_overflow.bind((0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__.Z)(t)),t.render_actionbutton=t.render_actionbutton.bind((0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__.Z)(t)),t.render_splitActionButton=t.render_splitActionButton.bind((0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__.Z)(t)),t.render_buttons=t.render_buttons.bind((0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__.Z)(t)),t.runAction=t.runAction.bind((0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__.Z)(t)),t.runWrappedAction=t.runWrappedAction.bind((0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_8__.Z)(t)),t}return(0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_9__.Z)(LinoBbar,[{key:"runWrappedAction",value:function runWrappedAction(action,tba,event){var _this2=this;if(action.window_action||this.setState({loadMask:!0}),tba.js_handler)return eval(tba.js_handler),void this.setState({loadMask:!1});var sr=this.props.sr.map(this.props.srMap),status={base_params:{}};this.props.mt&&(status.base_params.mt=this.props.mt),this.props.mk&&(status.base_params.mk=this.props.mk);var runnable={an:action.an,actorId:this.props.actorData.id,rp:this.props.rp,status,sr,onFinished:function(e){_this2.setState({loadMask:!1})}},response_callback=this.props.responseCallback(action);if(null!==response_callback&&(runnable.response_callback=response_callback),action.hasOwnProperty("actor")&&(runnable.actorId=action.actor,"grid"===action.an&&delete runnable.sr,"detail"===action.an&&-99998===parseInt(runnable.sr[0])&&(runnable.sr=[0])),event.ctrlKey){var newWindow=window.open(document.URL),count=0,waitForMountAndRun=function e(){if(newWindow.hasOwnProperty("App")&&!newWindow.App.state.site_loading&&void 0!==Object.values(newWindow.App.rps).find((function(e){return e.props.actorData.id===_this2.props.rp.props.actorData.id}))){var t=Object.values(newWindow.App.rps).find((function(e){return e.props.actorData.id===_this2.props.rp.props.actorData.id}));runnable.rp=t,newWindow.App.runAction(runnable)}else{if((count+=1)>20)return;setTimeout((function(){return e()}),100)}};waitForMountAndRun()}else window.App.runAction(runnable)}},{key:"runAction",value:function(e,t,n){e.window_action&&!t.js_handler||!detailDirty(e.an)?this.runWrappedAction(e,t,n):window.Detail.onDirtyLeave({},"INAPP",this.runWrappedAction,[e,t,n])}},{key:"render_overflow",value:function(){return React.createElement("div",null,React.createElement(Button,{icon:"pi pi-ellipsis-v",onClick:this.setState({overflowShow:!this.state.overflowShow})}),React.createElement("div",null))}},{key:"action2buttonProps",value:function(e,t,n){var r={label:t.label};return t.icon?(r.icon=t.icon,r.label=n?void 0:r.label):t.button_text&&(r.label=t.button_text),r.disabled=t.select_rows&&0===this.props.sr.length||this.props.disabledFields[t.an]||"submit_detail"===t.an&&!this.props.editing_mode||this.props.onSide&&!t.show_in_side_toolbar&&"submit_detail"!=t.an||this.props.nonCollapsibles&&!t.never_collapse,r.tooltip=e.help_text||t.label,r.tooltipOptions={position:this.props.onSide?"left":"bottom"},r}},{key:"render_actionbutton",value:function(e){var t=this,n=window.App.state.site_data.actions[e.an];if(n){var r=this.action2buttonProps(e,n,!0);if(r.disabled)return;return React.createElement(Button,(0,_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_10__.Z)({},r,{key:Math.random(),onClick:function(r){return t.props.runWrapper((function(){return t.runAction(n,e,r)}))}}))}}},{key:"render_splitActionButton",value:function(e){var t=this,n=e.menu.map((function(e){return window.App.state.site_data.actions[e.an]}));if(n[0]){var r=n.map((function(n,r){var o=t.action2buttonProps(e.menu[r],n);return o.command=function(o){return t.props.runWrapper((function(){return t.runAction(n,e.menu[r],o)}))},o})),o=this.action2buttonProps(e.menu[0],n[0],!0);if(o.disabled)return;return React.createElement(SplitButton,(0,_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_10__.Z)({appendTo:window.App.topDiv},o,{onClick:function(r){return t.props.runWrapper((function(){return t.runAction(n[0],e.menu[0],r)}))},key:Math.random(),model:r}))}}},{key:"render_buttons",value:function(){var e=this,t=this.props.actorData.actions_list.find((function(t){return t.an===e.props.an}));if(t){var n=t.toolbarActions;return n&&n.map((function(t,n){return t.combo?e.render_splitActionButton(t):e.render_actionbutton(t)}))}}},{key:"render",value:function(){return React.createElement(React.Fragment,null,this.state.loadMask&&React.createElement(LinoLoadMask,null),this.props.reload&&!this.props.nonCollapsibles&&!this.props.onSide&&React.createElement(Button,{icon:"pi pi-refresh",onClick:this.props.reload,tooltip:"Reload this view from the underlying database",tooltipOptions:{position:"bottom"}}),this.render_buttons())}}]),LinoBbar}(Component),LinoBbar.propTypes={actorData:PropTypes.object,an:PropTypes.string,sr:PropTypes.array,rp:PropTypes.any,reload:PropTypes.func,srMap:PropTypes.func,onSide:PropTypes.bool,nonCollapsibles:PropTypes.bool,runWrapper:PropTypes.func,disabledFields:PropTypes.object},LinoBbar.defaultProps={srMap:function(e){return e},sr:[],runWrapper:function(e){return e()},disabledFields:{}},_context.abrupt("return",[LinoBbar]);case 27:case"end":return _context.stop()}}),_callee)}))),_linoBbarGetter.apply(this,arguments)}var linoResolveGetter={resolveGetter:linoBbarGetter,resolveNames:["LinoBbar"]}},3698:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(9481),o=n.n(r)()((function(e){return e[1]}));o.push([e.id,".l-selected-menu {\n    background: black;\n}\nli.l-linked-menu.l-menuitem > a, li.l-menuitem.active-menuitem > a {\n    color: #0388e5;\n}\nul li.l-menuitem a {\n    color: #ffffff;\n}\n",""]);const a=o},5790:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(9481),o=n.n(r)()((function(e){return e[1]}));o.push([e.id,".l-site-title {\n    font-family: roman;\n    font-style: italic;\n    font-size: x-large;\n}\n",""]);const a=o},2435:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(9481),o=n.n(r)()((function(e){return e[1]}));o.push([e.id,".l-bbar .hidden{\n    opacity: 0;\n}\n.p-inputtext.p-component {\n    padding: 0.3rem 0.3rem;\n}\n.p-component.p-button {\n    background: transparent;\n    color: black;\n    border: 0;\n    padding: 0.3rem 0.3rem;\n    vertical-align: middle;\n    font-size: 0.85rem;\n}\n.p-component.p-button.p-button-icon-only {\n    width: 1.6rem;\n    padding: 0.3rem;\n}\n.p-button.p-button-icon-only .pi {\n    font-size: 0.85rem;\n}\n.p-splitbutton.p-component {\n    vertical-align: middle;\n}\ndiv.p-button.p-togglebutton.l-bbar-editor-button .p-button-icon-left {\n    color: black;\n}\n.l-whitewall-body-container div.p-button.p-togglebutton.l-bbar-editor-button .p-button-icon-left {\n    color: unset;\n}\ndiv.p-button.p-togglebutton.l-bbar-editor-button {\n    background: transparent;\n    border: 0;\n}\ndiv.p-button.p-togglebutton.l-bbar-editor-button:hover {\n    color: white;\n    background: #116fbf;\n    border-color: #116fbf;\n}\n.p-progress-spinner .p-progress-spinner-circle {\n    stroke-linecap: butt;\n}\n",""]);const a=o},5817:(e,t,n)=>{var r=n(3379),o=n.n(r),a=n(2435);o()(a.Z,{insert:"head",singleton:!1}),a.Z.locals}}]);